title: Съёмка стереопанорамы
-
author: Алексей Пушкарёв
-
short-content:Создание объёмных изображений это идея, которая никогда не теряла актуальности. Уже в античное фремя люди знали, что восприятие объёма возможно, так как два глаза видят немного отличающиеся картинки.
-
content: Создание объёмных изображений это идея, которая никогда не теряла актуальности. Уже в античное фремя люди знали, что восприятие объёма возможно, так как два глаза видят немного отличающиеся картинки. Логичной была бы мысль искусственно создавать такие изображения, чтобы передать ощущение объёма. Сейчас уже никто не скажет, когда и для чего впервые было создано стереоизображение, но свой взлёт эта технология начала уже в эпоху фотографии.

За полтора века было придумано множество способов создания и рассматривания стереоизображений, которые получили распространение — стереоскоп, стереограмма, анаглиф и другие технологии, связанные с очками. Свою долю известности получили шлемы виртуальной реальности. Несмотря на различную популярность, все эти технологии объединяет одно качество: трудоёмкость применения. Создание стереоизображений обходится дороже, а со стороны конечных операторов или пользователей требуются вложения в средства просмотра, поэтому объёмные картинки до сих пор остаются предметом одноразового развлечения.

Можно привести примеры современных технологий, у которых этот недостаток наименее проявлен:<br />
· анаглиф, появившийся ещё в 19 веке и с тех пор представленный в десятке разновидностей. Несмотря на трудности с передачей цвета и повышенное напряжение для глаз, получать такие изображения сейчас очень легко, а для просмотра нужны простые очки с двумя светофильтрами,<br />
· технология 3D Vision от Nvidia для компьютерных игр, в которой используются затворные стереоочки,<br />
· поляризованные стереоочки в индустрии кино,<br />
· лентикулярные дисплеи, которые уже устанавливают в смартфоны и видеокамеры. Эта технология наиболее близка к идеалу пользовательского устройства, так как не требует кроме экрана больше никаких приспособлений для просмотра. Её главный недостаток — низкое разрешение получаемого изображения (вдвое меньшее, чем у аналогичного дисплея без матрицы линз). Но эта технология ближе остальных приблизилась к потребительскому идеалу и не требует ничего, кроме минимально модифицированного экрана.<br />

Можно надеяться, что в недалёком будущем какая-то из технологий станет по-настоящему массовой, войдёт в каждый дом и придаст новое качество всем медиа, к которым мы уже привыкли: видео, фото, игры, User Experience и кто знает, чему ещё. :)

С появлением технологии виртуальных панорам, стереоизображения отметились и там, однако до настоящего времени их создание оставалось забавным опытом для профессионалов и отдано на откуп любителям. Всё потому, что современные инструменты демонстрации позволяют работать только с анаглифными изображениями, по сути одной панорамой, подготовленной заранее. А значит, применение такие панорамы найдут там, где без неудобных цветных очков никак не обойтись.

И всё же, при просмотре стереопанорамы рождается впечатление зрителя, который впервые увидел виртуальную панораму — ВАУ! Поэтому желание создавать стереопанорамы не переводится в любителях и профессионалах панорамной съёмки. Тем удивительнее практически полное отсутствие систематизированного опыта в этой области как в английском, так и в русском сегментах интернета.

Для опытного панорамного фотографа, уже владеющего навыками быстрой, качественной съёмки, сшивки и ретуши панорам перед созданием анаглифа встаёт вопрос: как получать параллакс? Хорошо, когда есть возможность установить две камеры на одно основание, настроить базу параллакса и снять две панорамы сразу, однако такой набор оборудования дорогой и тяжелый. Теоретически можно обойтись одной камерой и обычной панорамной головой.

Для простоты представим, что делается панорама замкнутого помещения, например, комнаты. С первой попытки можно просто взять и сместить штатив на расстояние базы, но тогда окажется, что в при сравнении финальных панорам база изменяется! Пояснение дано на рисунке 1.
Здесь О1 и О2, а так же белые кресты это проекции нодальных точек на вид сверху(как раз смещённый штатив),
Стрелки L1, L2, R1, R2 и так далее указывают направление взгляда камеры при повороте в азимутальной плоскости,
b — база.

Можно заметить, что при повороте от первого ракурса ко второму база начинает уменьшаться, при дальнейшем повороте обнуляется, а затем левое и правое меняются местами. Исправить изменение базы в зависимости от азимута невозможно без дополнительных больших трудностей в обработке(теоретически можно попытатся собирать панорамы по половинкам, снятых в точках О1 и О2). Да и само по себе изменение базы будет влиять на восприятие объёма.

Выход видится в нарушении правил съёмки, которые гласят, что нодальная точка объектива должна оставаться неподвижной в пространстве. Действительно, можно получить параллакс за счёт смещения настроек панорамной головы. Сделать это можно двумя способами: вперёд-назад относительно плоскости сенсора и влево-вправо в пределах этой плоскости. Сразу скажу, что смещение вперёд-назад значительно снижает качество сшивки панорамы, поэтому использовать его нет смысла, а вот к смещению влево-вправо качество сшивки практически нечувствительно. Более того, база съёмки сохранится неизменной.
Объяснение дано на рисунке 2:

Здесь показаны два положения нодальной точки: в точках А и B относительно оси О вращения головы. Горизонтальная синяя линия обозначает базу стереосъёмки. Изначально нодальная точка находилась в О. Стрелки обозначают направление взгляда камеры. При повороте от ракурса L1R1 к ракурсу L2R2 можно видеть, что база не изменяется. Таким образом будут получены две панорамы, которые не составит трудностей совместить. Нужно заметить, что такой способ съёмки может потребовать подгона панорам друг к другу, причём труднее всего такой подгон сделать для выправления горизонта. Так что выставление уровня лучше делать при съёмке. Зенит и надир полученной стереопанорамы будут выглядеть объёмно только в одном направлении, и полностью «антиобъёмно» в противоположном. Надир достаточно снять один раз.

Наконец, бывают съёмки, в которых можно пренебречь смещением нодальной точки, а базы должны быть большими, порядка метра. Я имею ввиду аэросъёмку. На неё хорошо ложится схема, показанная на рисунке 3:

Дистанция до объектов съёмки в этом случае намного превышает базу, поэтому для создания двух панорам можно брать ракурсы из каждой точки, они названы L1..L6 и R1..R6. База в идеальном случае сохраняется неизменной и некритичной к погрешностям.

Какая нужна база? В приведённых к статье примерах база составила всего 4см. Эффект кулисности при такой базе начинает проявлять себя с расстояния 6-8 метров. Наиболее близкий объект должен быть примерно в 10 раз больше базы, получается 40см, вплотную к камере. При сшивке панорам, снятых с отклонением от оси в 2 см трудностей даже с близкими объектами не возникает. Можно считать базу в 4-5см оптимальной при съёмке в помещениях.

Хорошие статьи по теме: <br />
1. Геометрия стереосъёмки, http://www.ixbt.com/digimage/stereogeometry.shtml <br />
2. История создания стереоизображений, http://fakturno.ru/a-znaete-li-vi-chto/istoriya-sozdaniya-stereoizobrazhenij.html <br />
3. Техника съемки сферической стерео панорамы, http://www.airpano.ru/Articles-AirPano.php?article=103407 <br />

Примеры стереопанорам даны ниже.