title: Съёмка стереопанорамы
-
author: Алексей Пушкарёв
-
short-content:Идея создания объёмных изображений никогда не теряла актуальности. Уже в античное время люди знали, что восприятие объёмной картинки возможно, поскольку человеческие глаза немного по-разному видят один и тот же объект.
-
content: 

Немного о технологиях
----------

Идея создания объёмных изображений никогда не теряла актуальности. Уже в античное время люди знали, что восприятие объёмной картинки возможно, поскольку человеческие глаза немного по-разному видят один и тот же объект. Сейчас уже сложно сказать, когда и для чего было создано стереоизображение, но популярность эта технология обрела в эпоху фотографии.


За полтора века было придумано множество способов создания и использования стереоизображений, среди них: стереоскоп, стереограмма, анаглиф и другие оптические технологии. Свою долю известности получили шлемы виртуальной реальности.

Однако, несмотря на свою популярность, все эти технологии объединяет один недостаток: трудоёмкость применения. Внушительных вложений требует не только создание стереоизображений, но и их просмотр, поэтому объёмные картинки до сих пор остаются одноразовым развлечением.

Среди технологий, у которых этот недостаток наименее проявлен:<br />
· <i>анаглиф</i>, появившийся ещё в 19 веке и с тех пор представленный в десятке разновидностей. Несмотря на трудности с передачей цвета и повышенное напряжение для глаз, получать такие изображения сейчас очень легко, а для просмотра нужны простые очки с двумя светофильтрами;<br />
· <i>технология 3D Vision от Nvidia</i> для компьютерных игр, использующая затворные стереоочки;<br />
· <i>поляризованные стереоочки</i>, которые активно используются в индустрии кино;<br />
· <i>лентикулярные дисплеи</i>, устанавливаемые в смартфоны и видеокамеры. Эта технология наиболее близка к идеалу пользовательского устройства, так как не требует специальных приспособлений для просмотра. Её главный недостаток — низкое разрешение получаемого изображения (вдвое меньшее, чем у аналогичного дисплея без матрицы линз).

Остается надеяться, что в недалёком будущем какая-то из технологий станет по-настоящему массовой, войдёт в каждый дом и поможет выйти на новый уровень уже привычным нам медиа: видео, фото, играм, User Experience и кто знает, чему ещё. :)

Техника съёмки стереопанорам
----------
<i>Пример стереопанорамы.</i>

<script type="text/javascript" src="@path/p821.js"></script>
<div class="row margin-40">
<div class="span12">
<section id="pano" style="height: 500px; width: 100%">
<script>
embedpano({swf:"@path/p821.swf", xml:"@path/p821.swf.xml", target:"pano", html5:"prefer", passQueryParameters:true});
</script>
</section>
</div>
</div>

Стереоизображения нашли свое применение в технологии съемки панорам, однако до настоящего времени их создание оставалось лишь забавным опытом для профессионалов и было отдано на откуп любителям. Всё потому, что современные инструменты демонстрации позволяют работать только с анаглифными изображениями, по сути одной панорамой, подготовленной заранее. А значит, применение такие панорамы найдут лишь при наличии цветных очков у зрителей.

И всё же, стереопанорамы производят сильное впечатление на неопытного зрителя. Поэтому желание создавать виртуальные панорамы у любителей и профессионалов панорамной съёмки не иссякает. Тем удивительнее практически полное отсутствие систематизированного опыта в этой области как в английском, так и в русском сегментах интернета.

У опытного панорамного фотографа, уже владеющего навыками быстрой, качественной съёмки, сшивки и ретуши панорам, перед созданием анаглифа встаёт вопрос: как получать эффект изменения линейных расстояний на изображении между предметами, расположенными на разных расстояниях от точки наблюдения (параллакс)? Хорошо, когда есть возможность установить две камеры на одно основание, настроить базу параллакса и снять две панорамы сразу, однако такой набор оборудования дорого обойдется и будет весьма громоздким. Теоретически можно обойтись одной камерой и обычной панорамной головой.

Для простоты представим, что необходимо создать панораму замкнутого помещения, например, комнаты. Сперва можно просто взять и сместить штатив на расстояние базы, но тогда окажется, что в при сравнении финальных панорам база изменяется. Пояснение дано на рисунке 1.<br />

Здесь О1 и О2, а также белые кресты -  это проекции нодальных точек на вид сверху (как раз смещённый штатив);<br />
Стрелки L1, L2, R1, R2 и так далее указывают направление взгляда камеры при повороте в азимутальной плоскости;<br />
b — база.

<center><img src="@path/fig0.jpg" width="600" height="400px"><br />
	Рис. 1</center>

Можно заметить, что при повороте от первого ракурса ко второму база начинает уменьшаться, при дальнейшем повороте обнуляется, а затем лево и право меняются местами. Исправить изменение базы в зависимости от азимута возможно лишь трудоемкой обработкой (теоретически можно попытаться собирать панорамы по половинкам, снятым в точках О1 и О2), да и само по себе изменение базы будет влиять на восприятие объёма.

Выход видится в нарушении правил съёмки, которые гласят, что нодальная точка объектива должна оставаться неподвижной в пространстве. Действительно, можно получить параллакс за счёт смещения настроек панорамной головы. Сделать это можно двумя способами: вперёд-назад относительно плоскости сенсора и влево-вправо в пределах этой плоскости. Примечательно, что смещение вперёд-назад значительно снижает качество сшивки панорамы, поэтому использовать его нет смысла, а вот смещение влево-вправо практически не сказывается на качестве сшивки.  Более того, база съёмки сохраняется неизменной. Объяснение дано на рисунке 2.

<center><img src="@path/fig1.jpg" width="600" height="400px"><br />
	Рис. 2</center>

Здесь показаны два положения нодальной точки: А и B относительно оси О вращения головы. Горизонтальная синяя линия обозначает базу стереосъёмки. Изначально нодальная точка находилась в О. Стрелки обозначают направление взгляда камеры. При повороте от ракурса L1R1 к ракурсу L2R2 можно видеть, что база не изменяется. Таким образом будут получены две панорамы, которые легко совместить. Необходимо отметить, что такой способ съёмки может потребовать подгона панорам друг к другу, причём труднее всего такой подгон сделать для выправления горизонта. Так что выставление уровня лучше делать при съёмке. Зенит и надир полученной стереопанорамы будут выглядеть объёмно только в одном направлении и полностью «антиобъёмно» в противоположном. Надир достаточно снять один раз.

Наконец, бывают съёмки, в которых можно пренебречь смещением нодальной точки, а базы должны быть большими, порядка метра. Речь идет об аэросъёмке. Для неё хорошо подходит схема, показанная на рисунке 3:

<center><img src="@path/fig2.jpg" width="600" height="400px"><br />
	Рис. 3</center>

Расстояние до объектов съёмки в этом случае намного превышает базу, поэтому для создания двух панорам можно брать ракурсы из каждой точки, они названы L1..L6 и R1..R6. База в идеальном случае сохраняется неизменной и некритичной к погрешностям.

Какая нужна база? В приведённом в начале статьи примере база составила всего 4 см. Эффект кулисности при такой базе начинает проявлять себя на расстоянии 6-8 метров. Наиболее близкий объект должен быть примерно в 10 раз больше базы, т.е. в данном случае - 40 см, вплотную к камере. При сшивке панорам, снятых с отклонением от оси в 2 см, трудностей даже с близкими объектами не возникает. Можно считать базу в 4-5 см оптимальной при съёмке в помещениях.

Хорошие статьи по теме: <br />
1. [Геометрия стереосъёмки](http://www.ixbt.com/digimage/stereogeometry.shtml) <br />
2. [История создания стереоизображений](http://fakturno.ru/a-znaete-li-vi-chto/istoriya-sozdaniya-stereoizobrazhenij.html) <br />
3. [Техника съемки сферической стерео панорамы](http://www.airpano.ru/Articles-AirPano.php?article=103407) <br />





